{% extends "base.html" %}

{% block title %}Dashboard - Face Recognition System{% endblock %}

{% block extra_css %}
<style>
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
    margin: 1rem 0;
}

.stat-card {
    background: white;
    padding: 1.5rem;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    text-align: center;
}

.stat-number {
    display: block;
    font-size: 2rem;
    font-weight: bold;
    color: #007bff;
}

.stat-label {
    display: block;
    margin-top: 0.5rem;
    color: #666;
}
</style>
{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <h1 class="mb-4">
                <i class="fas fa-tachometer-alt"></i>
                Admin Dashboard
                <span class="badge bg-success ms-2">Welcome, {{ current_user.username }}</span>
            </h1>
        </div>
    </div>
    
    <!-- Statistics -->
    <div class="stats-grid">
        <div class="stat-card">
            <span class="stat-number">{{ stats.total_students }}</span>
            <span class="stat-label">Registered Students</span>
        </div>
        <div class="stat-card">
            <span class="stat-number">{{ stats.total_attendance_today }}</span>
            <span class="stat-label">Attendance Today</span>
        </div>
        <div class="stat-card">
            <span class="stat-number">{{ stats.total_attendance_week }}</span>
            <span class="stat-label">This Week</span>
        </div>
        <div class="stat-card">
            <span class="stat-number">{{ stats.total_attendance_month }}</span>
            <span class="stat-label">This Month</span>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5>
                        <i class="fas fa-user-plus"></i>
                        Student Management
                    </h5>
                </div>
                <div class="card-body">
                    <p>Register new students and manage existing records with face data.</p>
                    <div class="d-flex gap-2">
                        <a href="{{ url_for('add_student') }}" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Add Student
                        </a>
                        <a href="{{ url_for('students') }}" class="btn btn-outline-primary">
                            <i class="fas fa-list"></i> View All
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5>
                        <i class="fas fa-brain"></i>
                        Face Training
                    </h5>
                </div>
                <div class="card-body">
                    <p>Train the face recognition model with student photos.</p>
                    <div class="d-flex gap-2">
                        <a href="{{ url_for('face_training') }}" class="btn btn-success">
                            <i class="fas fa-play"></i> Start Training
                        </a>
                        <a href="{{ url_for('asset_training.index') }}" class="btn btn-outline-success">
                            <i class="fas fa-database"></i> Asset Training
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5>
                        <i class="fas fa-camera"></i>
                        Recognition
                    </h5>
                </div>
                <div class="card-body">
                    <p>Recognize faces and mark attendance in real-time.</p>
                    <div class="d-flex gap-2">
                        <a href="{{ url_for('recognition') }}" class="btn btn-warning">
                            <i class="fas fa-eye"></i> Start Recognition
                        </a>
                        <a href="{{ url_for('attendance') }}" class="btn btn-outline-warning">
                            <i class="fas fa-calendar-check"></i> View Attendance
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5>
                        <i class="fas fa-chart-bar"></i>
                        Recent Activity
                    </h5>
                </div>
                <div class="card-body">
                    {% if recent_attendance %}
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Student</th>
                                        <th>Date</th>
                                        <th>Time</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for att in recent_attendance[:5] %}
                                    <tr>
                                        <td>{{ att.student_name or att.student_id }}</td>
                                        <td>{{ att.date }}</td>
                                        <td>{{ att.time }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        <a href="{{ url_for('attendance') }}" class="btn btn-sm btn-outline-primary">View All</a>
                    {% else %}
                        <p class="text-muted">No recent attendance records.</p>
                        <a href="{{ url_for('recognition') }}" class="btn btn-sm btn-primary">Start Taking Attendance</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
